# cronos-track-ibc-events

Python (Jupyter) notebooks to illustrate how to query IBC tranfers on Cronos chain.

# Overview

Cronos is a leading EVM-compatible blockchain network build on the Cosmos SDK. Cronos supports EVM smart contracts events as well as Cosmos/IBC transactions.

The native cryptocurrency of Cronos chain is CRO.

This means that, if you want to reconcile the CRO balance of an address with its transaction history, you need to look at :

- Cronos standard transactions (like on Ethereum)
- Internal transactions (like on Ethereum)
- IBC transactions associated with this address, which may have increased or decreased the CRO balance of this address (specific to Cronos)

If you want to reconcile the ERC20 balance of an address with its transaction history, you need to look at:

- ERC20 Transfer events (like on Ethereum)
- IBC transactions associated with this address, which may have increased or decreased the CRO balance of this address if this ERC20 token is supported by an IBC bridge on Cronos (specific to Cronos)

The purpose of this repository is to illustrate how this can be done.

- For now, the repository focuses on CRO balances and transactions.

# Installation

This repository assumes that you are familiar with Python, Jupyter notebooks, and have installed Poetry dependency manager (https://python-poetry.org/) on your machine.

However, if you prefer to use another language / framework, you can read the code and adapt it to your liking, since the code is mostly based on HTTP/REST requests which can be made in any language.

The Jupyter notebooks are best viewed using VS Code or Pycharm.

To install dependencies: `poetry install`

When executing the notebooks, please make sure that you have selected the local Poetry interpreter generated by the `poetry install` command.

To run script:

```shell
poetry shell
python query_ibc_transactions.py
```

# Get all IBC transactions

IBC activities can be queried using the `https://cronos.org/indexing/api/v1/bridges/activities` endpoint, which returns paginated responses.

# Get IBC transactions associated with a specific network and address

IBC activities can be queried using the `https://cronos.org/indexing/api/v1/bridges/{network}/account/{account}/activities` endpoint, which returns paginated responses.

The options available for {network} are:

- cronosevm (Cronos chain, when {account} is using an EVM address format)
- cronos (Cronos chain, when {account} is using the Cosmos address format)
- cryptoorgchain (Crypto.org chain)
- cosmoshub (Cosmos Hub)
- akash (currently not available yet)
- ethereum (currently not available yet)

See query_ibc_transactions.ipynb for an example.

# Get IBC transaction by transaction hash

A given transaction can be queried using the `https://cronos.org/indexing/api/v1/bridges/txs/{hash}` endpoint.

If the transaction has originated from an EVM wallet on Cronos, then it is also possible to find the transaction hash on https://cronoscan.com

See query_ibc_transactions.ipynb for an example.

# Convert Cronos EVM address into Cosmos address and vice versa

The bech32 package of Python can be used to convert addresses.

See query_ibc_transactions.ipynb for an example.

Alternatively, it is possible to use this web utility:

- Website: https://crypto-org-chain.github.io/cronos-address-webtool/
- Source Code (Javascript example); https://github.com/crypto-org-chain/cronos-address-webtool/blob/master/src/components/Home.vue#L61

For more details, visit https://docs.cronos.org/for-users/metamask#address-conventions.
